<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏±‡πà‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .slide-up {
            animation: slideUp 0.3s ease-out;
        }
        @keyframes slideUp {
            from { transform: translateY(100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-orange-50 to-red-50 min-h-screen">
    <!-- Customer Interface -->
    <div id="customerInterface" class="container mx-auto p-4">
        <!-- Header -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
            <h1 id="restaurantName" class="text-3xl font-bold text-center text-orange-600 mb-2">‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏≠‡∏£‡πà‡∏≠‡∏¢</h1>
            <p class="text-center text-gray-600">‡∏™‡∏±‡πà‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå ‡∏£‡∏™‡∏ä‡∏≤‡∏ï‡∏¥‡∏î‡∏µ ‡∏™‡πà‡∏á‡πÄ‡∏£‡πá‡∏ß</p>
        </div>

        <!-- Menu Section -->
        <div class="grid md:grid-cols-3 gap-6">
            <!-- Menu Items -->
            <div class="md:col-span-2">
                <h2 class="text-2xl font-bold mb-4 text-gray-800">‡πÄ‡∏°‡∏ô‡∏π‡∏≠‡∏≤‡∏´‡∏≤‡∏£</h2>
                <div id="menuContainer" class="grid gap-4">
                    <!-- Menu items will be populated here -->
                </div>
            </div>

            <!-- Cart -->
            <div class="bg-white rounded-lg shadow-lg p-6 h-fit sticky top-4">
                <h3 class="text-xl font-bold mb-4 text-gray-800">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</h3>
                <div id="cartItems" class="space-y-3 mb-4">
                    <p class="text-gray-500 text-center">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</p>
                </div>
                <div class="border-t pt-4">
                    <div class="flex justify-between font-bold text-lg mb-4">
                        <span>‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:</span>
                        <span id="totalPrice" class="text-orange-600">0 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <button id="checkoutBtn" class="w-full bg-orange-500 hover:bg-orange-600 text-white font-bold py-3 px-4 rounded-lg transition duration-200 disabled:bg-gray-300" disabled>
                        ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠
                    </button>
                </div>
            </div>
        </div>

        <!-- My Orders Section -->
        <div class="mt-8 bg-white rounded-lg shadow-lg p-6">
            <h3 class="text-xl font-bold mb-4 text-gray-800">‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</h3>
            <div id="customerOrders" class="space-y-4">
                <p class="text-gray-500 text-center">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</p>
            </div>
        </div>
    </div>

    <!-- Checkout Modal -->
    <div id="checkoutModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-lg p-6 m-4 max-w-md w-full max-h-[90vh] overflow-y-auto slide-up">
            <h3 class="text-xl font-bold mb-4">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</h3>
            
            <!-- Order Summary -->
            <div class="mb-4 p-4 bg-gray-50 rounded-lg">
                <h4 class="font-semibold mb-2">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠:</h4>
                <div id="checkoutItems"></div>
                <div class="border-t pt-2 mt-2 font-bold">
                    ‡∏£‡∏ß‡∏°: <span id="checkoutTotal"></span>
                </div>
            </div>

            <!-- Payment Method -->
            <div class="mb-4">
                <label class="block text-sm font-medium mb-2">‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô:</label>
                <select id="paymentMethod" class="w-full p-2 border rounded-lg">
                    <option value="cash">‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á</option>
                    <option value="transfer">‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô/‡∏™‡πÅ‡∏Å‡∏ô QR</option>
                </select>
            </div>

            <!-- Transfer Section -->
            <div id="transferSection" class="mb-4 hidden">
                <label class="block text-sm font-medium mb-2">‡πÅ‡∏ô‡∏ö‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô:</label>
                <input type="file" id="slipUpload" accept="image/*" class="w-full p-2 border rounded-lg">
                <div id="slipPreview" class="mt-2 hidden">
                    <img id="slipImage" class="max-w-full h-32 object-cover rounded-lg">
                </div>
            </div>

            <!-- Address -->
            <div class="mb-4">
                <label class="block text-sm font-medium mb-2">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á:</label>
                <textarea id="customerAddress" class="w-full p-2 border rounded-lg" rows="3" placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏±‡∏î‡∏™‡πà‡∏á"></textarea>
            </div>

            <div class="flex gap-2">
                <button id="cancelCheckout" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg">
                    ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                </button>
                <button id="confirmOrder" class="flex-1 bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg">
                    ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠
                </button>
            </div>
        </div>
    </div>

    <!-- Order Status Modal -->
    <div id="orderStatusModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-lg p-6 m-4 max-w-md w-full slide-up">
            <div class="text-center">
                <div class="text-6xl mb-4">‚úÖ</div>
                <h3 class="text-xl font-bold mb-2">‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</h3>
                <p class="text-gray-600 mb-4">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠: <span id="orderNumber" class="font-bold text-orange-600"></span></p>
                <div id="orderStatusInfo" class="bg-gray-50 p-4 rounded-lg mb-4">
                    <div class="flex items-center justify-center mb-2">
                        <div class="w-3 h-3 bg-yellow-500 rounded-full mr-2 pulse-animation"></div>
                        <span id="currentStatus">‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</span>
                    </div>
                </div>
                <button id="closeOrderStatus" class="bg-orange-500 hover:bg-orange-600 text-white font-bold py-2 px-4 rounded-lg">
                    ‡∏ï‡∏Å‡∏•‡∏á
                </button>
            </div>
        </div>
    </div>

    <!-- Owner Login -->
    <div id="ownerLogin" class="fixed bottom-4 right-4">
        <button id="ownerLoginBtn" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg shadow-lg">
            ‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô
        </button>
    </div>

    <!-- Owner Login Modal -->
    <div id="loginModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-lg p-6 m-4 max-w-sm w-full">
            <h3 class="text-xl font-bold mb-4">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô</h3>
            <input type="password" id="ownerPassword" class="w-full p-2 border rounded-lg mb-4" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">
            <div class="flex gap-2">
                <button id="cancelLogin" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg">
                    ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                </button>
                <button id="confirmLogin" class="flex-1 bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg">
                    ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
                </button>
            </div>
        </div>
    </div>

    <!-- Owner Interface -->
    <div id="ownerInterface" class="hidden container mx-auto p-4">
        <!-- Owner Header -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
            <div class="flex justify-between items-center">
                <h1 class="text-3xl font-bold text-blue-600">‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£</h1>
                <button id="logoutBtn" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg">
                    ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
                </button>
            </div>
        </div>

        <!-- Owner Tabs -->
        <div class="bg-white rounded-lg shadow-lg mb-6">
            <div class="flex border-b">
                <button class="owner-tab active px-6 py-3 font-semibold border-b-2 border-blue-500 text-blue-600" data-tab="restaurant">
                    ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡πâ‡∏≤‡∏ô
                </button>
                <button class="owner-tab px-6 py-3 font-semibold text-gray-600 hover:text-blue-600" data-tab="menu">
                    ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏ô‡∏π
                </button>
                <button class="owner-tab px-6 py-3 font-semibold text-gray-600 hover:text-blue-600" data-tab="orders">
                    ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠
                </button>
            </div>
        </div>

        <!-- Restaurant Info Tab -->
        <div id="restaurantTab" class="owner-tab-content bg-white rounded-lg shadow-lg p-6">
            <h3 class="text-xl font-bold mb-4">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡πâ‡∏≤‡∏ô</h3>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium mb-2">‡∏ä‡∏∑‡πà‡∏≠‡∏£‡πâ‡∏≤‡∏ô:</label>
                    <input type="text" id="restaurantNameInput" class="w-full p-2 border rounded-lg" value="‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏≠‡∏£‡πà‡∏≠‡∏¢">
                </div>
                <button id="updateRestaurantInfo" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg">
                    ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                </button>
            </div>
        </div>

        <!-- Menu Management Tab -->
        <div id="menuTab" class="owner-tab-content hidden bg-white rounded-lg shadow-lg p-6">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏ô‡∏π</h3>
                <button id="addMenuBtn" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg">
                    ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏°‡∏ô‡∏π
                </button>
            </div>
            <div id="ownerMenuList" class="space-y-4">
                <!-- Menu items for owner will be populated here -->
            </div>
        </div>

        <!-- Orders Tab -->
        <div id="ordersTab" class="owner-tab-content hidden bg-white rounded-lg shadow-lg p-6">
            <h3 class="text-xl font-bold mb-4">‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</h3>
            <div id="ownerOrdersList" class="space-y-4">
                <p class="text-gray-500 text-center">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</p>
            </div>
        </div>
    </div>



    <!-- Add/Edit Menu Modal -->
    <div id="menuModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-lg p-6 m-4 max-w-md w-full">
            <h3 id="menuModalTitle" class="text-xl font-bold mb-4">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏°‡∏ô‡∏π‡πÉ‡∏´‡∏°‡πà</h3>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium mb-2">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏°‡∏ô‡∏π:</label>
                    <input type="text" id="menuName" class="w-full p-2 border rounded-lg">
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2">‡∏£‡∏≤‡∏Ñ‡∏≤ (‡∏ö‡∏≤‡∏ó):</label>
                    <input type="number" id="menuPrice" class="w-full p-2 border rounded-lg">
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2">‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û:</label>
                    <input type="file" id="menuImage" accept="image/*" class="w-full p-2 border rounded-lg">
                    <div id="menuImagePreview" class="mt-2 hidden">
                        <img id="previewImage" class="max-w-full h-32 object-cover rounded-lg">
                    </div>
                </div>
            </div>
            <div class="flex gap-2 mt-6">
                <button id="cancelMenu" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg">
                    ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                </button>
                <button id="saveMenu" class="flex-1 bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg">
                    ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
                </button>
            </div>
        </div>
    </div>

    <script>
        // Global state management
        let appState = {
            restaurantName: '‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏≠‡∏£‡πà‡∏≠‡∏¢',
            menu: [
                { id: 1, name: '‡∏Ç‡πâ‡∏≤‡∏ß‡∏ú‡∏±‡∏î‡∏Å‡∏∏‡πâ‡∏á', price: 60, image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjRkZGN0VEIiByeD0iMTAiLz4KPGNpcmNsZSBjeD0iMTAwIiBjeT0iMTAwIiByPSI2MCIgZmlsbD0iI0ZGQjU2NiIvPgo8Y2lyY2xlIGN4PSI4NSIgY3k9Ijg1IiByPSI4IiBmaWxsPSIjRkY2QjZCIi8+CjxjaXJjbGUgY3g9IjEyMCIgY3k9IjkwIiByPSI2IiBmaWxsPSIjRkY2QjZCIi8+CjxjaXJjbGUgY3g9IjkwIiBjeT0iMTIwIiByPSI1IiBmaWxsPSIjNEVDRDcwIi8+CjxjaXJjbGUgY3g9IjExNSIgY3k9IjExNSIgcj0iNCIgZmlsbD0iIzRFQ0Q3MCIvPgo8L3N2Zz4K' },
                { id: 2, name: '‡∏ï‡πâ‡∏°‡∏¢‡∏≥‡∏Å‡∏∏‡πâ‡∏á', price: 80, image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjRkZGN0VEIiByeD0iMTAiLz4KPGVsbGlwc2UgY3g9IjEwMCIgY3k9IjE0MCIgcng9IjcwIiByeT0iNDAiIGZpbGw9IiNGRjZCNkIiLz4KPGVsbGlwc2UgY3g9IjEwMCIgY3k9IjEzNSIgcng9IjY1IiByeT0iMzUiIGZpbGw9IiNGRkE1MDAiLz4KPGNpcmNsZSBjeD0iOTAiIGN5PSIxMjAiIHI9IjgiIGZpbGw9IiNGRjZCNkIiLz4KPGNpcmNsZSBjeD0iMTEwIiBjeT0iMTI1IiByPSI2IiBmaWxsPSIjRkY2QjZCIi8+CjxlbGxpcHNlIGN4PSI4NSIgY3k9IjEzNSIgcng9IjE1IiByeT0iOCIgZmlsbD0iIzRFQ0Q3MCIvPgo8L3N2Zz4K' },
                { id: 3, name: '‡∏ú‡∏±‡∏î‡πÑ‡∏ó‡∏¢', price: 50, image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjRkZGN0VEIiByeD0iMTAiLz4KPGVsbGlwc2UgY3g9IjEwMCIgY3k9IjEwMCIgcng9IjcwIiByeT0iNTAiIGZpbGw9IiNGRkI1NjYiLz4KPHBhdGggZD0iTTUwIDkwUTE1MCA4MCA5MCA2MFExMzAgNzAgMTUwIDEwMFE4MCA4MCA2MCA5MFE5MCA4MCA1MCA5MFoiIGZpbGw9IiNGRkE1MDAiLz4KPGNpcmNsZSBjeD0iNzAiIGN5PSIxMTAiIHI9IjQiIGZpbGw9IiNGRjZCNkIiLz4KPGNpcmNsZSBjeD0iMTMwIiBjeT0iMTA1IiByPSI1IiBmaWxsPSIjRkY2QjZCIi8+CjxlbGxpcHNlIGN4PSIxMTAiIGN5PSIxMjAiIHJ4PSIxMCIgcnk9IjUiIGZpbGw9IiM0RUNENDQ3MCIvPgo8L3N2Zz4K' }
            ],
            cart: [],
            orders: [],
            currentOrderId: 1000,
            isOwnerLoggedIn: false,
            editingMenuId: null
        };

        // Global cloud storage - all devices use the same store automatically
        let storeId = 'global_restaurant_store'; // Fixed ID for all devices
        let deviceId = localStorage.getItem('deviceId') || 'device_' + Math.random().toString(36).substr(2, 9);
        localStorage.setItem('deviceId', deviceId);

        // Save state to cloud (simulated with localStorage but with shared key)
        function saveState() {
            try {
                // Save to localStorage as backup
                localStorage.setItem('foodOrderingApp', JSON.stringify(appState));
                
                // Simulate cloud save with timestamp for sync
                const cloudData = {
                    ...appState,
                    lastUpdated: Date.now(),
                    storeId: storeId
                };
                localStorage.setItem('cloudData_' + storeId, JSON.stringify(cloudData));
                
                // Broadcast changes to other tabs/windows
                window.dispatchEvent(new CustomEvent('dataUpdated', { detail: cloudData }));
            } catch (error) {
                console.error('Error saving data:', error);
            }
        }

        // Load state from cloud
        function loadState() {
            try {
                // Try to load from cloud first
                const cloudSaved = localStorage.getItem('cloudData_' + storeId);
                if (cloudSaved) {
                    const cloudData = JSON.parse(cloudSaved);
                    appState = { ...appState, ...cloudData };
                } else {
                    // Fallback to local storage
                    const localSaved = localStorage.getItem('foodOrderingApp');
                    if (localSaved) {
                        appState = { ...appState, ...JSON.parse(localSaved) };
                    }
                }
            } catch (error) {
                console.error('Error loading data:', error);
            }
        }

        // Sync data across devices/tabs
        function syncData() {
            try {
                const cloudSaved = localStorage.getItem('cloudData_' + storeId);
                if (cloudSaved) {
                    const cloudData = JSON.parse(cloudSaved);
                    if (cloudData.lastUpdated > (appState.lastUpdated || 0)) {
                        appState = { ...appState, ...cloudData };
                        updateUI();
                    }
                }
            } catch (error) {
                console.error('Error syncing data:', error);
            }
        }

        // Update UI after sync
        function updateUI() {
            renderMenu();
            renderCart();
            renderCustomerOrders();
            updateRestaurantName();
            if (appState.isOwnerLoggedIn) {
                renderOwnerMenu();
                renderOwnerOrders();
            }
        }

        // Initialize app
        function initApp() {
            loadState();
            renderMenu();
            renderCart();
            renderCustomerOrders();
            updateRestaurantName();
            
            // Show sync status
            showSyncStatus();
            
            // Real-time sync across all devices automatically
            setInterval(() => {
                syncData();
                if (appState.isOwnerLoggedIn) {
                    renderOwnerOrders();
                }
                renderCustomerOrders();
            }, 2000);
            
            // Listen for data updates from other tabs/windows
            window.addEventListener('dataUpdated', function(event) {
                if (event.detail.storeId === storeId) {
                    appState = { ...appState, ...event.detail };
                    updateUI();
                }
            });
            
            // Listen for storage changes (cross-device sync)
            window.addEventListener('storage', function(event) {
                if (event.key === 'cloudData_' + storeId) {
                    syncData();
                }
            });
            
            // Show welcome message for automatic sync
            setTimeout(() => {
                if (!localStorage.getItem('welcomeShown')) {
                    alert('üéâ ‡∏£‡∏∞‡∏ö‡∏ö‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥!\n\n‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≤‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÇ‡∏î‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥\n‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡πÉ‡∏î‡πÜ ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡∏à‡∏≤‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÑ‡∏´‡∏ô‡∏Å‡πá‡πÑ‡∏î‡πâ');
                    localStorage.setItem('welcomeShown', 'true');
                }
            }, 1000);
        }

        // Show device sync status
        function showSyncStatus() {
            const syncStatusDiv = document.createElement('div');
            syncStatusDiv.id = 'syncStatus';
            syncStatusDiv.className = 'fixed top-4 left-4 bg-green-100 border border-green-300 rounded-lg p-3 text-sm z-40';
            syncStatusDiv.innerHTML = `
                <div class="flex items-center gap-2">
                    <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                    <span class="font-semibold text-green-800">‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≤‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</span>
                </div>
                <div class="text-xs text-green-600 mt-1">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏ó‡∏∏‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</div>
                <button onclick="hideSyncStatus()" class="bg-green-500 hover:bg-green-600 text-white text-xs py-1 px-2 rounded mt-2">
                    ‡∏ã‡πà‡∏≠‡∏ô
                </button>
            `;
            document.body.appendChild(syncStatusDiv);
        }

        // Hide sync status
        function hideSyncStatus() {
            const syncStatus = document.getElementById('syncStatus');
            if (syncStatus) {
                syncStatus.style.display = 'none';
            }
        }

        // Update restaurant name
        function updateRestaurantName() {
            document.getElementById('restaurantName').textContent = appState.restaurantName;
        }

        // Render menu items
        function renderMenu() {
            const container = document.getElementById('menuContainer');
            container.innerHTML = '';
            
            appState.menu.forEach(item => {
                const menuItem = document.createElement('div');
                menuItem.className = 'bg-white rounded-lg shadow-md p-4 fade-in';
                menuItem.innerHTML = `
                    <img src="${item.image}" alt="${item.name}" class="w-full h-32 object-cover rounded-lg mb-3">
                    <h4 class="font-semibold text-lg mb-2">${item.name}</h4>
                    <div class="flex justify-between items-center">
                        <span class="text-orange-600 font-bold text-lg">${item.price} ‡∏ö‡∏≤‡∏ó</span>
                        <button onclick="addToCart(${item.id})" class="bg-orange-500 hover:bg-orange-600 text-white font-bold py-2 px-4 rounded-lg transition duration-200">
                            ‡πÄ‡∏û‡∏¥‡πà‡∏°
                        </button>
                    </div>
                `;
                container.appendChild(menuItem);
            });
        }

        // Add item to cart
        function addToCart(itemId) {
            const item = appState.menu.find(m => m.id === itemId);
            const existingItem = appState.cart.find(c => c.id === itemId);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                appState.cart.push({ ...item, quantity: 1 });
            }
            
            renderCart();
            saveState();
        }

        // Remove item from cart
        function removeFromCart(itemId) {
            appState.cart = appState.cart.filter(item => item.id !== itemId);
            renderCart();
            saveState();
        }

        // Update cart quantity
        function updateCartQuantity(itemId, change) {
            const item = appState.cart.find(c => c.id === itemId);
            if (item) {
                item.quantity += change;
                if (item.quantity <= 0) {
                    removeFromCart(itemId);
                } else {
                    renderCart();
                    saveState();
                }
            }
        }

        // Render cart
        function renderCart() {
            const container = document.getElementById('cartItems');
            const totalElement = document.getElementById('totalPrice');
            const checkoutBtn = document.getElementById('checkoutBtn');
            
            if (appState.cart.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-center">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</p>';
                totalElement.textContent = '0 ‡∏ö‡∏≤‡∏ó';
                checkoutBtn.disabled = true;
                return;
            }
            
            container.innerHTML = '';
            let total = 0;
            
            appState.cart.forEach(item => {
                const cartItem = document.createElement('div');
                cartItem.className = 'flex justify-between items-center p-2 bg-gray-50 rounded';
                cartItem.innerHTML = `
                    <div class="flex-1">
                        <div class="font-medium">${item.name}</div>
                        <div class="text-sm text-gray-600">${item.price} ‡∏ö‡∏≤‡∏ó</div>
                    </div>
                    <div class="flex items-center gap-2">
                        <button onclick="updateCartQuantity(${item.id}, -1)" class="bg-red-500 hover:bg-red-600 text-white w-6 h-6 rounded-full text-sm">-</button>
                        <span class="w-8 text-center">${item.quantity}</span>
                        <button onclick="updateCartQuantity(${item.id}, 1)" class="bg-green-500 hover:bg-green-600 text-white w-6 h-6 rounded-full text-sm">+</button>
                    </div>
                `;
                container.appendChild(cartItem);
                total += item.price * item.quantity;
            });
            
            totalElement.textContent = `${total} ‡∏ö‡∏≤‡∏ó`;
            checkoutBtn.disabled = false;
        }

        // Show checkout modal
        function showCheckout() {
            const modal = document.getElementById('checkoutModal');
            const itemsContainer = document.getElementById('checkoutItems');
            const totalElement = document.getElementById('checkoutTotal');
            
            itemsContainer.innerHTML = '';
            let total = 0;
            
            appState.cart.forEach(item => {
                const div = document.createElement('div');
                div.className = 'flex justify-between text-sm mb-1';
                div.innerHTML = `
                    <span>${item.name} x${item.quantity}</span>
                    <span>${item.price * item.quantity} ‡∏ö‡∏≤‡∏ó</span>
                `;
                itemsContainer.appendChild(div);
                total += item.price * item.quantity;
            });
            
            totalElement.textContent = `${total} ‡∏ö‡∏≤‡∏ó`;
            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }

        // Handle payment method change
        function handlePaymentMethodChange() {
            const paymentMethod = document.getElementById('paymentMethod').value;
            const transferSection = document.getElementById('transferSection');
            
            if (paymentMethod === 'transfer') {
                transferSection.classList.remove('hidden');
            } else {
                transferSection.classList.add('hidden');
            }
        }

        // Handle slip upload
        function handleSlipUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const preview = document.getElementById('slipPreview');
                    const image = document.getElementById('slipImage');
                    image.src = e.target.result;
                    preview.classList.remove('hidden');
                };
                reader.readAsDataURL(file);
            }
        }

        // Confirm order
        function confirmOrder() {
            const address = document.getElementById('customerAddress').value.trim();
            const paymentMethod = document.getElementById('paymentMethod').value;
            
            if (!address) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á');
                return;
            }
            
            if (paymentMethod === 'transfer') {
                const slipFile = document.getElementById('slipUpload').files[0];
                if (!slipFile) {
                    alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÅ‡∏ô‡∏ö‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô');
                    return;
                }
            }
            
            // Create order
            const order = {
                id: appState.currentOrderId++,
                items: [...appState.cart],
                total: appState.cart.reduce((sum, item) => sum + (item.price * item.quantity), 0),
                address: address,
                paymentMethod: paymentMethod,
                slip: paymentMethod === 'transfer' ? document.getElementById('slipImage').src : null,
                status: '‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô',
                timestamp: new Date().toLocaleString('th-TH')
            };
            
            appState.orders.push(order);
            appState.cart = [];
            
            // Hide checkout modal
            document.getElementById('checkoutModal').classList.add('hidden');
            document.getElementById('checkoutModal').classList.remove('flex');
            
            // Show order status modal
            showOrderStatus(order);
            
            renderCart();
            renderCustomerOrders();
            saveState();
        }

        // Show order status modal
        function showOrderStatus(order) {
            const modal = document.getElementById('orderStatusModal');
            const orderNumber = document.getElementById('orderNumber');
            const currentStatus = document.getElementById('currentStatus');
            
            orderNumber.textContent = `#${order.id}`;
            currentStatus.textContent = order.status;
            
            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }

        // Render customer orders
        function renderCustomerOrders() {
            const container = document.getElementById('customerOrders');
            
            if (appState.orders.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-center">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</p>';
                return;
            }
            
            container.innerHTML = '';
            
            appState.orders.forEach(order => {
                const orderDiv = document.createElement('div');
                orderDiv.className = 'border rounded-lg p-4 bg-gray-50';
                
                const statusColor = {
                    '‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô': 'text-yellow-600',
                    '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥': 'text-blue-600',
                    '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á': 'text-purple-600',
                    '‡∏™‡πà‡∏á‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß': 'text-green-600'
                };
                
                orderDiv.innerHTML = `
                    <div class="flex justify-between items-start mb-2">
                        <div>
                            <h4 class="font-semibold">‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ #${order.id}</h4>
                            <p class="text-sm text-gray-600">${order.timestamp}</p>
                        </div>
                        <div class="text-right">
                            <div class="font-bold ${statusColor[order.status] || 'text-gray-600'}">${order.status}</div>
                            <div class="text-lg font-bold text-orange-600">${order.total} ‡∏ö‡∏≤‡∏ó</div>
                        </div>
                    </div>
                    <div class="text-sm text-gray-600 mb-2">
                        ${order.items.map(item => `${item.name} x${item.quantity}`).join(', ')}
                    </div>
                    <div class="text-sm text-gray-600 mb-2">
                        <strong>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà:</strong> ${order.address}
                    </div>
                    <div class="text-sm text-gray-600">
                        <strong>‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô:</strong> ${order.paymentMethod === 'cash' ? '‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á' : '‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô'}
                        ${order.slip ? '<button onclick="showSlip(\'' + order.slip + '\')" class="ml-2 text-blue-600 hover:underline">‡∏î‡∏π‡∏™‡∏•‡∏¥‡∏õ</button>' : ''}
                    </div>
                    ${order.status !== '‡∏™‡πà‡∏á‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß' ? `
                        <button onclick="cancelOrder(${order.id})" class="mt-2 bg-red-500 hover:bg-red-600 text-white text-sm py-1 px-3 rounded">
                            ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠
                        </button>
                    ` : ''}
                `;
                container.appendChild(orderDiv);
            });
        }

        // Cancel order
        function cancelOrder(orderId) {
            if (confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                appState.orders = appState.orders.filter(order => order.id !== orderId);
                renderCustomerOrders();
                saveState();
            }
        }

        // Show slip image
        function showSlip(slipSrc) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="max-w-md max-h-[90vh] p-4">
                    <img src="${slipSrc}" class="max-w-full max-h-full object-contain rounded-lg">
                    <button onclick="this.parentElement.parentElement.remove()" class="mt-4 w-full bg-white text-black py-2 px-4 rounded-lg">
                        ‡∏õ‡∏¥‡∏î
                    </button>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // Owner login
        function showOwnerLogin() {
            document.getElementById('loginModal').classList.remove('hidden');
            document.getElementById('loginModal').classList.add('flex');
        }

        function confirmLogin() {
            const password = document.getElementById('ownerPassword').value;
            if (password === '1234') {
                appState.isOwnerLoggedIn = true;
                document.getElementById('loginModal').classList.add('hidden');
                document.getElementById('loginModal').classList.remove('flex');
                document.getElementById('customerInterface').classList.add('hidden');
                document.getElementById('ownerInterface').classList.remove('hidden');
                document.getElementById('ownerLogin').classList.add('hidden');
                renderOwnerMenu();
                renderOwnerOrders();
                document.getElementById('restaurantNameInput').value = appState.restaurantName;
            } else {
                alert('‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
            }
            document.getElementById('ownerPassword').value = '';
        }

        function logout() {
            appState.isOwnerLoggedIn = false;
            document.getElementById('customerInterface').classList.remove('hidden');
            document.getElementById('ownerInterface').classList.add('hidden');
            document.getElementById('ownerLogin').classList.remove('hidden');
        }

        // Owner tabs
        function switchOwnerTab(tabName) {
            // Update tab buttons
            document.querySelectorAll('.owner-tab').forEach(tab => {
                tab.classList.remove('active', 'border-blue-500', 'text-blue-600');
                tab.classList.add('text-gray-600');
            });
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active', 'border-blue-500', 'text-blue-600');
            document.querySelector(`[data-tab="${tabName}"]`).classList.remove('text-gray-600');
            
            // Update tab content
            document.querySelectorAll('.owner-tab-content').forEach(content => {
                content.classList.add('hidden');
            });
            document.getElementById(`${tabName}Tab`).classList.remove('hidden');
        }

        // Update restaurant info
        function updateRestaurantInfo() {
            const newName = document.getElementById('restaurantNameInput').value.trim();
            if (newName) {
                appState.restaurantName = newName;
                updateRestaurantName();
                saveState();
                alert('‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡πâ‡∏≤‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
            }
        }

        // Show add menu modal
        function showAddMenu() {
            appState.editingMenuId = null;
            document.getElementById('menuModalTitle').textContent = '‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏°‡∏ô‡∏π‡πÉ‡∏´‡∏°‡πà';
            document.getElementById('menuName').value = '';
            document.getElementById('menuPrice').value = '';
            document.getElementById('menuImage').value = '';
            document.getElementById('menuImagePreview').classList.add('hidden');
            document.getElementById('menuModal').classList.remove('hidden');
            document.getElementById('menuModal').classList.add('flex');
        }

        // Show edit menu modal
        function showEditMenu(menuId) {
            const menu = appState.menu.find(m => m.id === menuId);
            if (menu) {
                appState.editingMenuId = menuId;
                document.getElementById('menuModalTitle').textContent = '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏°‡∏ô‡∏π';
                document.getElementById('menuName').value = menu.name;
                document.getElementById('menuPrice').value = menu.price;
                document.getElementById('previewImage').src = menu.image;
                document.getElementById('menuImagePreview').classList.remove('hidden');
                document.getElementById('menuModal').classList.remove('hidden');
                document.getElementById('menuModal').classList.add('flex');
            }
        }

        // Handle menu image upload
        function handleMenuImageUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const preview = document.getElementById('menuImagePreview');
                    const image = document.getElementById('previewImage');
                    image.src = e.target.result;
                    preview.classList.remove('hidden');
                };
                reader.readAsDataURL(file);
            }
        }

        // Save menu
        function saveMenu() {
            const name = document.getElementById('menuName').value.trim();
            const price = parseInt(document.getElementById('menuPrice').value);
            const imageFile = document.getElementById('menuImage').files[0];
            
            if (!name || !price) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô');
                return;
            }
            
            if (appState.editingMenuId) {
                // Edit existing menu
                const menu = appState.menu.find(m => m.id === appState.editingMenuId);
                menu.name = name;
                menu.price = price;
                if (imageFile) {
                    menu.image = document.getElementById('previewImage').src;
                }
            } else {
                // Add new menu
                const newMenu = {
                    id: Math.max(...appState.menu.map(m => m.id)) + 1,
                    name: name,
                    price: price,
                    image: imageFile ? document.getElementById('previewImage').src : 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjRjNGNEY2IiByeD0iMTAiLz4KPHRleHQgeD0iMTAwIiB5PSIxMDAiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzZCNzI4MCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPuC4o+C4ueC4m+C4oOC4suC4nuC4reC4suC4q+C4suC4o+C5jDwvdGV4dD4KPC9zdmc+'
                };
                appState.menu.push(newMenu);
            }
            
            document.getElementById('menuModal').classList.add('hidden');
            document.getElementById('menuModal').classList.remove('flex');
            renderMenu();
            renderOwnerMenu();
            saveState();
        }

        // Delete menu
        function deleteMenu(menuId) {
            if (confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡πÄ‡∏°‡∏ô‡∏π‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                appState.menu = appState.menu.filter(m => m.id !== menuId);
                renderMenu();
                renderOwnerMenu();
                saveState();
            }
        }

        // Render owner menu list
        function renderOwnerMenu() {
            const container = document.getElementById('ownerMenuList');
            container.innerHTML = '';
            
            appState.menu.forEach(menu => {
                const menuDiv = document.createElement('div');
                menuDiv.className = 'flex items-center gap-4 p-4 border rounded-lg';
                menuDiv.innerHTML = `
                    <img src="${menu.image}" alt="${menu.name}" class="w-16 h-16 object-cover rounded-lg">
                    <div class="flex-1">
                        <h4 class="font-semibold">${menu.name}</h4>
                        <p class="text-orange-600 font-bold">${menu.price} ‡∏ö‡∏≤‡∏ó</p>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="showEditMenu(${menu.id})" class="bg-blue-500 hover:bg-blue-600 text-white py-1 px-3 rounded">
                            ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
                        </button>
                        <button onclick="deleteMenu(${menu.id})" class="bg-red-500 hover:bg-red-600 text-white py-1 px-3 rounded">
                            ‡∏•‡∏ö
                        </button>
                    </div>
                `;
                container.appendChild(menuDiv);
            });
        }

        // Update order status
        function updateOrderStatus(orderId, newStatus) {
            const order = appState.orders.find(o => o.id === orderId);
            if (order) {
                order.status = newStatus;
                renderOwnerOrders();
                renderCustomerOrders();
                saveState();
            }
        }

        // Delete order
        function deleteOrder(orderId) {
            if (confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                appState.orders = appState.orders.filter(order => order.id !== orderId);
                renderOwnerOrders();
                renderCustomerOrders();
                saveState();
            }
        }

        // Render owner orders
        function renderOwnerOrders() {
            const container = document.getElementById('ownerOrdersList');
            
            if (appState.orders.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-center">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</p>';
                return;
            }
            
            container.innerHTML = '';
            
            appState.orders.forEach(order => {
                const orderDiv = document.createElement('div');
                orderDiv.className = 'border rounded-lg p-4 bg-gray-50';
                
                const statusOptions = ['‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô', '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥', '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á', '‡∏™‡πà‡∏á‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß'];
                const statusSelect = statusOptions.map(status => 
                    `<option value="${status}" ${order.status === status ? 'selected' : ''}>${status}</option>`
                ).join('');
                
                orderDiv.innerHTML = `
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <h4 class="font-semibold text-lg">‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ #${order.id}</h4>
                            <p class="text-sm text-gray-600">${order.timestamp}</p>
                        </div>
                        <div class="text-right">
                            <div class="text-lg font-bold text-orange-600">${order.total} ‡∏ö‡∏≤‡∏ó</div>
                            <div class="text-sm text-gray-600">${order.paymentMethod === 'cash' ? '‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á' : '‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô'}</div>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <strong>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£:</strong>
                        <div class="text-sm text-gray-600 ml-4">
                            ${order.items.map(item => `${item.name} x${item.quantity} = ${item.price * item.quantity} ‡∏ö‡∏≤‡∏ó`).join('<br>')}
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <strong>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á:</strong>
                        <div class="text-sm text-gray-600 ml-4">${order.address}</div>
                    </div>
                    
                    ${order.slip ? `
                        <div class="mb-3">
                            <strong>‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô:</strong>
                            <button onclick="showSlip('${order.slip}')" class="ml-2 text-blue-600 hover:underline text-sm">
                                ‡∏î‡∏π‡∏™‡∏•‡∏¥‡∏õ
                            </button>
                        </div>
                    ` : ''}
                    
                    <div class="flex gap-2 items-center">
                        <label class="font-medium">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</label>
                        <select onchange="updateOrderStatus(${order.id}, this.value)" class="border rounded px-2 py-1">
                            ${statusSelect}
                        </select>
                        <button onclick="deleteOrder(${order.id})" class="ml-auto bg-red-500 hover:bg-red-600 text-white text-sm py-1 px-3 rounded">
                            ‡∏•‡∏ö
                        </button>
                    </div>
                `;
                container.appendChild(orderDiv);
            });
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            initApp();
            
            // Customer interface events
            document.getElementById('checkoutBtn').addEventListener('click', showCheckout);
            document.getElementById('cancelCheckout').addEventListener('click', function() {
                document.getElementById('checkoutModal').classList.add('hidden');
                document.getElementById('checkoutModal').classList.remove('flex');
            });
            document.getElementById('confirmOrder').addEventListener('click', confirmOrder);
            document.getElementById('closeOrderStatus').addEventListener('click', function() {
                document.getElementById('orderStatusModal').classList.add('hidden');
                document.getElementById('orderStatusModal').classList.remove('flex');
            });
            document.getElementById('paymentMethod').addEventListener('change', handlePaymentMethodChange);
            document.getElementById('slipUpload').addEventListener('change', handleSlipUpload);
            
            // Owner login events
            document.getElementById('ownerLoginBtn').addEventListener('click', showOwnerLogin);
            document.getElementById('cancelLogin').addEventListener('click', function() {
                document.getElementById('loginModal').classList.add('hidden');
                document.getElementById('loginModal').classList.remove('flex');
            });
            document.getElementById('confirmLogin').addEventListener('click', confirmLogin);
            document.getElementById('logoutBtn').addEventListener('click', logout);
            
            // Owner interface events
            document.querySelectorAll('.owner-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    switchOwnerTab(this.dataset.tab);
                });
            });
            
            document.getElementById('updateRestaurantInfo').addEventListener('click', updateRestaurantInfo);
            document.getElementById('addMenuBtn').addEventListener('click', showAddMenu);
            document.getElementById('cancelMenu').addEventListener('click', function() {
                document.getElementById('menuModal').classList.add('hidden');
                document.getElementById('menuModal').classList.remove('flex');
            });
            document.getElementById('saveMenu').addEventListener('click', saveMenu);
            document.getElementById('menuImage').addEventListener('change', handleMenuImageUpload);
            
            // Enter key for login
            document.getElementById('ownerPassword').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    confirmLogin();
                }
            });


        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97c7a4fe81a63f93',t:'MTc1NzQzMDk2My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
